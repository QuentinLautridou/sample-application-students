language: java
jdk: oraclejdk8

env:
  global:
    - secure: A4G/oPzl7Lm9NHLftHYdYN5F8GwOV+KImpByhdCo9OQ0cNR/ImdeosTp3H+XRAdHkazuwAzPayfGWQbNjMjT7tfQGN2iRRDdfJo65YYGBD/AlrkQDGRYx0bLDwiWzS6LJmiSNeCy9aOf0OMak8kHdvPj3AtdumcS136FR2GyqSZ0MSMYMgF1F3A90L09lOq7aF9m9uAYhJmv55NVi9F8Ax43jsAkcOKdZgT7Z/zPKWHZ30ez9kCfsifCFrwhKx8UsTHfQjapVRWF5qF3kUWzYJLw2GsA4psJUUwXvbzEfF9XgXR4U/76DKjwaEwHQil2QhYZUbjzA6B6ArbTG7NNjwGhqRgRVv9/Rgax0StccbUUa8TgUBCrP+WW9B8tbgtM0EnQB0Hr7R6jIxWkSpEyvRwpLcZ4QLM2TGpMt/pmmKEh5KY8tFH+hRsLUv+t6D1s8iJfGcH+nFbLxgnkUfrGwxvbCOKQ90CVAWBjv4okFhvFnRXyfgvKdDiywwS5LWQBzWNn9nUOmAeISTM5W00N0eHKXs3ogZQzLZeeTCmJDV9Ew8ved71vWijvIDXjmcqw0PdWBRZ+sawNTJOhONHZzTaUiPlJoOD7wBvRxjUr9UK0GlRwY2jAvAka2xykksiIIloHrZ100Km9+hduX3ucQ/84+rYolfG9Pob4f/9Hf2k=

services:
  - docker

before_install:
  - sudo service mysql stop
  - docker pull takimatraining/devops-training-db
  - docker run -d -p 127.0.0.1:3306:3306 takimatraining/devops-training-db

script:
  - |
    mvn clean install sonar:sonar \
    -Dsonar.projectKey=<SONAR_PROJECT_KEY> \
    -Dsonar.organization=<SONAR_ORGANISATION_KEY> \
    -Dsonar.host.url=https://sonarcloud.io \
    -Dsonar.login=$SONAR_TOKEN
  - mvn verify
